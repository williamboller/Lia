<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />

  <!-- ‚úÖ iPhone safe-area + full screen sizing -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>

  <title>Countdown to Lia</title>

  <!-- ‚úÖ Makes Safari / iOS UI match your background (reduces the "white bar" look) -->
  <meta name="theme-color" content="#0b1020">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Countdown ‚ù§Ô∏è">

  <!-- Favicon ‚ù§Ô∏è -->
  <link rel="icon" type="image/svg+xml"
        href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">‚ù§Ô∏è</text></svg>'>

  <!-- ‚úÖ Home Screen icon (add this file to your repo root) -->
  <!-- Put a 180x180 PNG named apple-touch-icon.png next to index.html -->
  <link rel="apple-touch-icon" href="apple-touch-icon.png">

  <!-- ‚úÖ Optional PWA manifest (create manifest.webmanifest + icons) -->
  <link rel="manifest" href="manifest.webmanifest">

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#111a33;

      --text:#eaf0ff;
      --muted:#b7c0dd;

      --shadow: 0 20px 60px rgba(0,0,0,.35);
      --stroke: rgba(255,255,255,.10);
      --card: rgba(15, 23, 42, .78);

      /* dynamic accent (JS updates) */
      --accent2: rgba(122,162,255,.22);
      --accent3: rgba(122,162,255,.16);
    }

    *{ box-sizing:border-box; }

    /* ‚úÖ Prevent white behind Safari UI / safe areas */
    html, body{
      height:100%;
      background:#0b1020;
    }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;

      /* ‚úÖ safe-area aware padding */
      padding:
        calc(32px + env(safe-area-inset-top))
        16px
        calc(32px + env(safe-area-inset-bottom));

      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;

      background:
        radial-gradient(900px 500px at 15% 20%, var(--accent2), transparent 60%),
        radial-gradient(900px 500px at 85% 80%, var(--accent3), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));

      transition: background 600ms ease, color 400ms ease;
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
    }

    /* Starfield canvas behind everything */
    #stars{
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: .35;
    }

    .wrap{
      width:min(980px, 100%);
      text-align:center;
      position: relative;
      z-index: 1;
    }

    /* Tabs */
    .tabs{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-bottom:14px;
      flex-wrap:wrap;
    }
    .tab{
      appearance:none;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(234,240,255,.9);
      padding: 10px 14px;
      border-radius: 999px;
      font-weight: 800;
      letter-spacing: -0.01em;
      cursor: pointer;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
    }
    .tab:hover{ transform: translateY(-1px); }
    .tab.active{
      background: rgba(122,162,255,.16);
      border-color: rgba(122,162,255,.35);
      color: rgba(234,240,255,1);
    }

    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 28px;
      padding: 44px 22px 36px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      transition: border-color 500ms ease, box-shadow 500ms ease;
    }

    h1{
      margin:0 0 12px;
      font-size: clamp(34px, 5vw, 72px);
      font-weight:900;
      letter-spacing: -0.02em;
    }

    /* ‚úÖ Rotator (now UNDER countdown) */
    .rotator{
      margin: 14px 0 8px;
      min-height: 20px;
      font-size: 15px;
      color: rgba(234,240,255,.92);
      opacity: .92;
      font-weight: 700;
      transition: opacity 240ms ease, transform 240ms ease;
      transform: translateY(0);
    }
    .rotator.fadeOut{
      opacity: 0;
      transform: translateY(6px);
    }
    .rotator.fadeIn{
      opacity: .92;
      transform: translateY(0);
    }

    .sub{
      font-size: 22px;
      color: var(--muted);
      margin-bottom: 8px;
      font-weight: 750;
    }

    .milestone{
      margin: 0 0 14px;
      font-size: 15px;
      color: rgba(234,240,255,.9);
      opacity: .95;
      font-weight: 750;
      min-height: 20px;
    }

    .countGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:12px;
      margin: 12px auto 10px;
      padding:14px;
      border-radius:18px;
      background: rgba(122,162,255,.07);
      border:1px solid rgba(122,162,255,.18);
      transition: background 500ms ease, border-color 500ms ease;
    }

    .unit{
      padding:14px;
      border-radius:16px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.09);
      position: relative;
      overflow: hidden;
      transition: transform 180ms ease, border-color 500ms ease, box-shadow 500ms ease, background 500ms ease;
    }

    .num{
      font-size: 38px;
      font-weight:900;
      display:inline-block;
      transition: transform 180ms ease, opacity 180ms ease;
      will-change: transform, opacity;
    }
    .num.bump{
      transform: translateY(-6px) scale(1.03);
      opacity: .92;
    }

    .lbl{
      margin-top:6px;
      font-size:13px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.1em;
      font-weight: 800;
    }

    .unit.clickable{ cursor:pointer; }
    .unit.clickable:hover{ transform: translateY(-2px); }

    /* seconds glow */
    .unit.seconds{
      border-color: rgba(122,162,255,.30);
      box-shadow: 0 0 0 rgba(122,162,255,0);
    }
    .unit.seconds::before{
      content:"";
      position:absolute;
      inset:-40%;
      background: radial-gradient(circle at 50% 50%, rgba(122,162,255,.35), transparent 55%);
      opacity:.20;
      animation: glowPulse 1.6s ease-in-out infinite;
      pointer-events:none;
    }
    .unit.seconds::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius:16px;
      box-shadow: 0 0 22px rgba(122,162,255,.18);
      opacity:.35;
      animation: glowRing 1.6s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes glowPulse{
      0%,100%{ transform: scale(.94); opacity:.18; }
      50%{ transform: scale(1.02); opacity:.30; }
    }
    @keyframes glowRing{
      0%,100%{ opacity:.22; }
      50%{ opacity:.42; }
    }

    /* hint */
    .hint{
      margin: 8px 0 18px;
      font-size: 13px;
      color: rgba(183,192,221,.9);
      letter-spacing: .02em;
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
    }

    .sectionTitle{
      font-size:32px;
      margin: 18px 0 14px;
      font-weight:900;
      letter-spacing: -0.02em;
    }

    .statsGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }

    .statCard{
      padding:16px;
      border-radius:18px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.09);
      transition: border-color 500ms ease, background 500ms ease;
    }

    .statLabel{
      font-size:13px;
      color:var(--muted);
      letter-spacing:.1em;
      text-transform:uppercase;
      margin-bottom:6px;
      font-weight: 800;
    }

    .statValue{
      font-size:28px;
      font-weight:900;
      letter-spacing: -0.02em;
      display:inline-block;
      transition: transform 180ms ease, opacity 180ms ease;
      will-change: transform, opacity;
    }
    .statValue.bump{
      transform: translateY(-4px) scale(1.01);
      opacity: .92;
    }

    .soon{
      margin-top: 18px;
      font-size:16px;
      opacity:.9;
      font-weight: 800;
    }

    .panel{ display:none; }
    .panel.active{ display:block; }

    /* Modal */
    .modalOverlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.55);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 9999;
      backdrop-filter: blur(6px);
    }
    .modalOverlay.show{ display:flex; }

    .modal{
      width: min(540px, 100%);
      border-radius: 20px;
      background: rgba(15, 23, 42, .92);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 30px 80px rgba(0,0,0,.45);
      padding: 18px 18px 14px;
      text-align: left;
      position: relative;
    }
    .modal h3{
      margin: 2px 0 10px;
      font-size: 18px;
      letter-spacing: -0.01em;
    }
    .modal p{
      margin: 0 0 12px;
      color: rgba(234,240,255,.92);
      line-height: 1.35;
      font-size: 15px;
    }
    .modal .x{
      position:absolute;
      top: 10px;
      right: 10px;
      width: 38px;
      height: 38px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(234,240,255,.9);
      font-size: 18px;
      font-weight: 900;
      cursor: pointer;
    }
    .modal .x:hover{
      background: rgba(122,162,255,.18);
      border-color: rgba(122,162,255,.35);
    }

    @media (max-width:720px){
      .countGrid{ grid-template-columns: repeat(2,1fr); }
      .statsGrid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <canvas id="stars"></canvas>

  <div class="wrap">
    <div class="tabs" role="tablist" aria-label="Countdown tabs">
      <button class="tab active" id="tabCountdown" type="button">Until</button>
      <button class="tab" id="tabSince" type="button">Since</button>
    </div>

    <!-- PANEL: COUNTDOWN -->
    <div class="panel active" id="panelCountdown">
      <div class="card">
        <h1>Will Sees Lia</h1>

        <div class="sub">In</div>
        <div class="milestone" id="milestoneCountdown"></div>

        <div class="countGrid">
          <div class="unit"><div class="num" id="d">‚Äî</div><div class="lbl" id="dLbl">Days</div></div>
          <div class="unit"><div class="num" id="h">‚Äî</div><div class="lbl" id="hLbl">Hours</div></div>
          <div class="unit"><div class="num" id="m">‚Äî</div><div class="lbl" id="mLbl">Minutes</div></div>

          <div class="unit seconds clickable" id="secondsBox" title="Click for a secret">
            <div class="num" id="s">‚Äî</div>
            <div class="lbl" id="sLbl">Seconds</div>
          </div>
        </div>

        <!-- rotator under countdown -->
        <div class="rotator" id="rotatorCountdown"></div>

        <!-- hint under rotator -->
        <div class="hint">‚ú® Psst‚Ä¶ click <b>SECONDS</b> for a secret</div>

        <div class="sectionTitle">That‚Äôs</div>

        <div class="statsGrid">
          <div class="statCard">
            <div class="statLabel">Total Hours</div>
            <div class="statValue" id="th">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Total Minutes</div>
            <div class="statValue" id="tm">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Total Seconds</div>
            <div class="statValue" id="ts">‚Äî</div>
          </div>
        </div>
      </div>

      <div class="soon">See you soon ‚ù§Ô∏è</div>
    </div>

    <!-- PANEL: SINCE -->
    <div class="panel" id="panelSince">
      <div class="card">
        <h1>We Saw Each Other</h1>

        <div class="rotator" id="rotatorSince"></div>
        <div class="sub">Since 12/19/2025 ‚Ä¢ 4:20 PM ET</div>

        <div class="milestone" id="milestoneSince"></div>

        <div class="countGrid">
          <div class="unit"><div class="num" id="sd">‚Äî</div><div class="lbl" id="sdLbl">Days</div></div>
          <div class="unit"><div class="num" id="sh">‚Äî</div><div class="lbl" id="shLbl">Hours</div></div>
          <div class="unit"><div class="num" id="sm">‚Äî</div><div class="lbl" id="smLbl">Minutes</div></div>
          <div class="unit"><div class="num" id="ss">‚Äî</div><div class="lbl" id="ssLbl">Seconds</div></div>
        </div>

        <div class="sectionTitle">That‚Äôs</div>

        <div class="statsGrid">
          <div class="statCard">
            <div class="statLabel">Total Hours</div>
            <div class="statValue" id="sth">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Total Minutes</div>
            <div class="statValue" id="stm">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Total Seconds</div>
            <div class="statValue" id="sts">‚Äî</div>
          </div>
        </div>
      </div>

      <div class="soon">One day closer ‚ù§Ô∏è</div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modalOverlay" id="modalOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button class="x" id="modalClose" aria-label="Close">‚úï</button>
      <h3 id="modalTitle">Secret</h3>
      <p id="modalText">Loading‚Ä¶</p>
    </div>
  </div>

  <script>
    // Countdown target: Jan 4, 2026 at 12:00 PM Eastern (EST=UTC-5) => 17:00 UTC
    const TARGET = Date.UTC(2026,0,4,17,0,0);
    // Since start: Dec 19, 2025 at 4:20 PM Eastern => 21:20 UTC
    const SINCE = Date.UTC(2025,11,19,21,20,0);

    // Countdown elements
    const d=document.getElementById("d"),
          h=document.getElementById("h"),
          m=document.getElementById("m"),
          s=document.getElementById("s"),
          th=document.getElementById("th"),
          tm=document.getElementById("tm"),
          ts=document.getElementById("ts");

    const dLbl=document.getElementById("dLbl"),
          hLbl=document.getElementById("hLbl"),
          mLbl=document.getElementById("mLbl"),
          sLbl=document.getElementById("sLbl");

    const milestoneCountdown = document.getElementById("milestoneCountdown");
    const rotatorCountdown = document.getElementById("rotatorCountdown");
    const secondsBox = document.getElementById("secondsBox");

    // Since elements
    const sd=document.getElementById("sd"),
          sh=document.getElementById("sh"),
          sm=document.getElementById("sm"),
          ss=document.getElementById("ss"),
          sth=document.getElementById("sth"),
          stm=document.getElementById("stm"),
          sts=document.getElementById("sts");

    const sdLbl=document.getElementById("sdLbl"),
          shLbl=document.getElementById("shLbl"),
          smLbl=document.getElementById("smLbl"),
          ssLbl=document.getElementById("ssLbl");

    const milestoneSince = document.getElementById("milestoneSince");
    const rotatorSince = document.getElementById("rotatorSince");

    // Tabs
    const tabCountdown = document.getElementById("tabCountdown");
    const tabSince = document.getElementById("tabSince");
    const panelCountdown = document.getElementById("panelCountdown");
    const panelSince = document.getElementById("panelSince");

    tabCountdown.addEventListener("click", () => {
      tabCountdown.classList.add("active");
      tabSince.classList.remove("active");
      panelCountdown.classList.add("active");
      panelSince.classList.remove("active");
    });

    tabSince.addEventListener("click", () => {
      tabSince.classList.add("active");
      tabCountdown.classList.remove("active");
      panelSince.classList.add("active");
      panelCountdown.classList.remove("active");
    });

    // Modal
    const modalOverlay = document.getElementById("modalOverlay");
    const modalClose = document.getElementById("modalClose");
    const modalText = document.getElementById("modalText");

    function openModal(text){
      modalText.textContent = text;
      modalOverlay.classList.add("show");
      modalOverlay.setAttribute("aria-hidden","false");
    }
    function closeModal(){
      modalOverlay.classList.remove("show");
      modalOverlay.setAttribute("aria-hidden","true");
    }
    modalClose.addEventListener("click", closeModal);
    modalOverlay.addEventListener("click", (e) => { if (e.target === modalOverlay) closeModal(); });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

    // Helpers
    const pad=n=>String(n).padStart(2,"0");
    const fmt=n=>n.toLocaleString("en-US");

    function plural(n, one, many){
      return (n===1) ? one : many;
    }

    function bump(el, cls="bump"){
      el.classList.remove(cls);
      void el.offsetWidth;
      el.classList.add(cls);
      setTimeout(() => el.classList.remove(cls), 190);
    }

    function setNumber(el, newText){
      if (el.textContent !== newText){
        el.textContent = newText;
        bump(el, "bump");
      }
    }

    function setStat(el, newText){
      if (el.textContent !== newText){
        el.textContent = newText;
        bump(el, "bump");
      }
    }

    // Theme: time-of-day + urgency shifts
    function applyTheme(secondsRemaining){
      const hour = new Date().getHours();
      let bg1 = "#0b1020", bg2 = "#111a33";

      if (hour >= 6 && hour < 12){        bg1 = "#0a1330"; bg2 = "#121f45"; }
      else if (hour >= 12 && hour < 18){  bg1 = "#08102a"; bg2 = "#0f1a3a"; }
      else if (hour >= 18 && hour < 22){  bg1 = "#090f24"; bg2 = "#0d1635"; }
      else {                               bg1 = "#060a18"; bg2 = "#0a1128"; }

      let a2 = "rgba(122,162,255,.22)";
      let a3 = "rgba(122,162,255,.16)";
      let borderHot = "rgba(122,162,255,.18)";

      if (secondsRemaining <= 3600 * 24){
        a2 = "rgba(255,105,180,.22)";
        a3 = "rgba(255,165,0,.14)";
        borderHot = "rgba(255,105,180,.22)";
      } else if (secondsRemaining <= 3600 * 24 * 7){
        a2 = "rgba(122,255,197,.18)";
        a3 = "rgba(122,162,255,.14)";
        borderHot = "rgba(122,255,197,.20)";
      }

      document.documentElement.style.setProperty("--bg1", bg1);
      document.documentElement.style.setProperty("--bg2", bg2);
      document.documentElement.style.setProperty("--accent2", a2);
      document.documentElement.style.setProperty("--accent3", a3);

      document.querySelectorAll(".countGrid").forEach(g => g.style.borderColor = borderHot);
    }

    // Milestones
    function milestoneText(secondsRemaining){
      if (secondsRemaining <= 0) return "It‚Äôs time. ‚ù§Ô∏è";
      if (secondsRemaining <= 10) return "Ten seconds.";
      if (secondsRemaining <= 60) return "Less than a minute.";
      if (secondsRemaining <= 60 * 5) return "Five minutes or less.";
      if (secondsRemaining <= 60 * 30) return "Under 30 minutes.";
      if (secondsRemaining <= 3600) return "Less than an hour.";
      if (secondsRemaining <= 3600 * 6) return "Today.";
      if (secondsRemaining <= 3600 * 24) return "Tomorrow.";
      if (secondsRemaining <= 3600 * 24 * 2) return "Two days.";
      if (secondsRemaining <= 3600 * 24 * 3) return "Three days.";
      if (secondsRemaining <= 3600 * 24 * 7) return "One week.";
      return "Counting down‚Ä¶";
    }

    function milestoneTextSince(totalSeconds){
      if (totalSeconds < 30) return "Just now.";
      if (totalSeconds < 60) return "Less than a minute.";
      if (totalSeconds < 60 * 10) return "A few minutes ago.";
      if (totalSeconds < 3600) return "Less than an hour ago.";
      if (totalSeconds < 3600 * 6) return "Earlier today.";
      if (totalSeconds < 3600 * 24) return "Today.";
      if (totalSeconds < 3600 * 48) return "Yesterday.";
      return "Time keeps moving‚Ä¶";
    }

    // Rotators
    const rotateCountdownLines = [
      "Every second closer.",
      "Worth the wait ‚ù§Ô∏è",
      "Don‚Äôt blink.",
      "Quietly counting down‚Ä¶",
      "Almost there (soon).",
      "This is the part where time crawls üò≠",
      "Okay‚Ä¶ okay‚Ä¶ okay‚Ä¶",
    ];

    const rotateSinceLines = [
      "Time since that moment.",
      "Still thinking about it.",
      "Feels longer than it is.",
      "Counting up until the next one.",
      "Time moves‚Ä¶ but not fast enough.",
    ];

    function startRotator(el, lines){
      let idx = Math.floor(Math.random() * lines.length);
      el.textContent = lines[idx];

      setInterval(() => {
        el.classList.add("fadeOut");
        setTimeout(() => {
          idx = (idx + 1) % lines.length;
          el.textContent = lines[idx];
          el.classList.remove("fadeOut");
          el.classList.add("fadeIn");
          setTimeout(() => el.classList.remove("fadeIn"), 260);
        }, 260);
      }, 7000);
    }

    // Fun facts
    function randomFact(secondsRemaining){
      const totalMinutes = Math.floor(secondsRemaining / 60);
      const totalHours = Math.floor(secondsRemaining / 3600);
      const totalDays = Math.floor(secondsRemaining / 86400);

      const songs3min = Math.floor(totalMinutes / 3);
      const eps22min = Math.floor(totalMinutes / 22);
      const heartbeats = Math.floor(secondsRemaining * 1.2);
      const breaths = Math.floor(secondsRemaining / 4);
      const sunsets = totalDays + (secondsRemaining > 0 ? 1 : 0);

      const facts = [
        `That‚Äôs ${fmt(totalMinutes)} minutes left.`,
        `That‚Äôs ${fmt(totalHours)} hours left.`,
        `Roughly ${fmt(songs3min)} three-minute songs.`,
        `About ${fmt(eps22min)} episodes of a 22-minute show.`,
        `Approx. ${fmt(heartbeats)} heartbeats until then. ‚ù§Ô∏è`,
        `Approx. ${fmt(breaths)} breaths until then.`,
        `That‚Äôs about ${fmt(sunsets)} sunsets away.`,
        `Math check: ${fmt(secondsRemaining)} seconds = ${fmt(totalMinutes)} minutes = ${fmt(totalHours)} hours.`,
        `You‚Äôre ${fmt(totalDays)} day(s) out ‚Äî and getting closer.`,
        `Secret: if you‚Äôre reading this, you found the button üòå`,
      ];
      return facts[Math.floor(Math.random() * facts.length)];
    }

    secondsBox.addEventListener("click", () => {
      const rem = window._lastRemainingSeconds ?? 0;
      openModal(randomFact(rem));
    });

    // Ticks
    function tickCountdown(){
      let diff = TARGET - Date.now();
      if(diff < 0) diff = 0;

      const sec = Math.floor(diff/1000);
      window._lastRemainingSeconds = sec;

      const days=Math.floor(sec/86400);
      const hrs=Math.floor((sec%86400)/3600);
      const mins=Math.floor((sec%3600)/60);
      const secs=sec%60;

      setNumber(d, fmt(days));
      setNumber(h, pad(hrs));
      setNumber(m, pad(mins));
      setNumber(s, pad(secs));

      dLbl.textContent = plural(days, "Day", "Days");
      hLbl.textContent = plural(hrs, "Hour", "Hours");
      mLbl.textContent = plural(mins, "Minute", "Minutes");
      sLbl.textContent = plural(secs, "Second", "Seconds");

      setStat(th, fmt(Math.floor(sec/3600)));
      setStat(tm, fmt(Math.floor(sec/60)));
      setStat(ts, fmt(sec));

      milestoneCountdown.textContent = milestoneText(sec);
      applyTheme(sec);

      if (sec <= 3600*24){
        secondsBox.style.borderColor = "rgba(255,105,180,.40)";
      } else if (sec <= 3600*24*7){
        secondsBox.style.borderColor = "rgba(122,255,197,.35)";
      } else {
        secondsBox.style.borderColor = "rgba(122,162,255,.30)";
      }
    }

    function tickSince(){
      let diff = Date.now() - SINCE;
      if(diff < 0) diff = 0;

      const sec = Math.floor(diff/1000);

      const days=Math.floor(sec/86400);
      const hrs=Math.floor((sec%86400)/3600);
      const mins=Math.floor((sec%3600)/60);
      const secs=sec%60;

      setNumber(sd, fmt(days));
      setNumber(sh, pad(hrs));
      setNumber(sm, pad(mins));
      setNumber(ss, pad(secs));

      sdLbl.textContent = plural(days, "Day", "Days");
      shLbl.textContent = plural(hrs, "Hour", "Hours");
      smLbl.textContent = plural(mins, "Minute", "Minutes");
      ssLbl.textContent = plural(secs, "Second", "Seconds");

      setStat(sth, fmt(Math.floor(sec/3600)));
      setStat(stm, fmt(Math.floor(sec/60)));
      setStat(sts, fmt(sec));

      milestoneSince.textContent = milestoneTextSince(sec);
    }

    function tickAll(){
      tickCountdown();
      tickSince();
    }

    // Starfield
    function startStars(){
      const canvas = document.getElementById("stars");
      const ctx = canvas.getContext("2d");
      let w, h, dpr;
      let stars = [];

      function resize(){
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        w = canvas.width = Math.floor(window.innerWidth * dpr);
        h = canvas.height = Math.floor(window.innerHeight * dpr);
        canvas.style.width = window.innerWidth + "px";
        canvas.style.height = window.innerHeight + "px";

        const count = Math.floor((window.innerWidth * window.innerHeight) / 18000);
        stars = Array.from({length: Math.max(60, Math.min(160, count))}, () => ({
          x: Math.random() * w,
          y: Math.random() * h,
          r: (Math.random() * 1.4 + 0.4) * dpr,
          a: Math.random() * 0.55 + 0.15,
          vy: (Math.random() * 0.06 + 0.02) * dpr,
          tw: Math.random() * 0.8 + 0.2,
          t: Math.random() * Math.PI * 2,
        }));
      }

      function draw(){
        ctx.clearRect(0,0,w,h);
        for (const s of stars){
          s.t += 0.008 * s.tw;
          const alpha = s.a + Math.sin(s.t) * 0.10;

          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(234,240,255,${Math.max(0, Math.min(0.8, alpha))})`;
          ctx.fill();

          s.y += s.vy;
          if (s.y > h + 10) { s.y = -10; s.x = Math.random() * w; }
        }
        requestAnimationFrame(draw);
      }

      resize();
      window.addEventListener("resize", resize);
      draw();
    }

    // Start
    startRotator(rotatorCountdown, rotateCountdownLines);
    startRotator(rotatorSince, rotateSinceLines);
    startStars();

    tickAll();
    setInterval(tickAll, 1000);
  </script>
</body>
</html>
